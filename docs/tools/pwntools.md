---
title: "pwntools"
layout: default
parent: "Tools"
nav_order: 3
---

## pwntools

pwntools is a python library used to automate and standardise the exploitation of binaries. I will provide a high level description of the library here, but the following resources will be helpful in becoming more comfortable with the library:
- The [online tutorial](https://github.com/Gallopsled/pwntools-tutorial) provided by the authors of the library is the best resource for learning how to use it.
- The [official documentation](https://docs.pwntools.com/en/latest/index.html) is a valuable resource to lookup the functionality of specific functions.
- This [cheat sheet](https://gist.github.com/anvbis/64907e4f90974c4bdd930baeb705dedf) demonstrates the usage of some commonly used functions, which is handy to have when starting out.

### Installation

The library can be installed like all other packages using a command like:

```
$ python3 -m pip install --upgrade pwntools
```

The installation can be verified by running the command:

```
$ python3 -c "from pwn import *"
```

If this gives no errors then the installation was successful.

### Basic Use

The utility of pwntools is its ability to allow attackers to perform I/O operations on an active binary from a python script. Of concern to us will be binaries running locally on our machine, or as a remote TCP/UDP connection. Interacting with these objects takes place through the creation of tube objects, which has a variety of methods for sending an receiving data

#### Local Tubes

A tube for a binary physically present on the disk can be done by calling the `process()` command:

``` python
local_tube = process('path/to/binary')
```

This will be the primary mode of binary interaction we will be using in this tutorial. Most binary exploitation CTFs come with a binary that can (and should) be downloaded and explored to identify vulnerabilities.
#### Remote Tubes

A tube for a remote TCP or UDP process can be set up using the `remote()` command:

``` python
remote_tube = remote('<host>', <port>)
```

Note that the host should be past as a sting, and the port an integer. Many binaries can be trivially exploited if the flag is contained within the code the binary is created from (look into the `strings` command). To combat this, many CTF binaries are run remotely and read the flag in from a flag.txt file (or something similar). Thus remote tubes will be important once the exploit has been realised and the flag can be obtained.

#### I/O operations

Once in communication with the binary, we can interact with it by sending and receiving data. The main methods that allow us to do this are the `sendline()` and `recvline()` methods. The following example demonstrates their usage:

``` python
shell_tube = process("sh")
shell_tube.sendline("echo hello, world")
response = shell_tube.recvline()           # Response should be "hello"
```

The first line starts a shell as a local process. The second line sends the command `echo hello, world` to the shell. The third line receives the first line of output from the shell command, which should be the string "hello, world".

There are many other (similar) methods for sending and receiving data, but only one more will be discussed here. The `recvuntil(<delim>)` method receives input until the delimiter string is read. As an example, consider a binary that prints many lines of information before prompting the user for input with `> `. An example interaction with this binary would be as follows:

``` python
tube = process("mybinary")
tube.recvuntil("> ")
tube.sendline("hello, world")
```

The second line reads the output sent by the binary until the delimiter `> ` is reached. The third line sends the the string "hello, world" after this delimiter has been read.

#### Closing a tube

Tubes can be closed by calling the `close()` method:

``` python
tube = process("sh")
tube.close()
```

In the case of CTFs that result in remote code execution and access to a privileged shell, the exploiter can regain control over the I/O to the binary with the `ineractive()` method:

``` python
tube = process("sh")
tube.interactive()  
```

This basic introduction should be sufficient to understand how pwntools scripts work at a high level. More information can be found at the resources linked above.